# MarkdownからHTMLへの変換を行うスクリプト

これはMarkdownの入っているディレクトリ構造をコピーしながらHTMLを生成するスクリプトです。
主な動きは以下になります。

* src/以下にMarkdownでページコンテンツを書く。
    * ファイル名は `半角英数.md` 厳守！
    * _から始まるファイルは無視されます。
    * 始めの一行目には必ず `# ページタイトル` を入れること(HTMLのタイトルに使われる)。
* `npm run update` を実行。
    * `template.html` の中身を解析し、テンプレートを作成する。
    * 後はsrc/以下のMarkdownファイルの構造を再現しながら、HTMLファイルをテンプレートを元に生成する。
    * 最後には追加されたファイルを `git add -A` で自動追加する。
* Githubにpushするとそのままページ公開！
    * 自分がいいと思った時点で `git commit` でコミットし、`git push` でアップロードする。

簡単！！

## トップページについて

仕様上必ずMarkdownで書いたページは指定ディレクトリ（今回だと`page/`）以下に配置されるので、トップページは自分で用意する必要があります。
そこに関してはがんばれ。

## ページについて

階層構造をコピーするものの、テンプレートではベースとなるパスを返す程度のことしかできません。
なので、以下のようなことに注意してください。

* ベースURLを設定しない場合には、CSS等のリンクは基本絶対パスもしくはディレクトリの絶対パス(`/`から始まる)にすること。
* ベースURLを設定した場合、基準がトップページになるので、全てのパスはトップページからアクセス可能なパスで記述すること。

個人的には上の対策より下の対策の方が圧倒的に楽なので、下で頑張った方がいいと思います。

## テンプレートについて

基本はHTMLですが、いくつか変わったところがあります。

* `{var:変数名}` というテンプレートの値を入れる場所がある。
    * スクリプトで定義された値に置換される。
* src/のディレクトリ構造を再現するので、パスには気を付ける。
    * ベースとなるURLはプログラムに任せると相対パス編集してくれる。
    * CSSや画像パスで絶対に変わってほしくないものは `/` から始まるディレクトリの絶対パス扱いにすることも視野に入れる。

CSSや必要な画像は必要な場所にそのまま置いておく形になります。

プログラムで置換される変数は以下の者が用意されています。

* title
    * ページタイトル。
    * そのMarkdownの初めに出てくる `# ` 見出しの内容が入る。
* html
    * 本文。
* menu
    * メニュー。
* src
    * 元のMarkdownへのパス。ダウンロードなどが可能なパスになっている。
* base
    * TOPページがどこになるかを示す。
    * そのため、`../` がいくつ存在するかという話になる。
    * `<base href="{var:base}">` が基本的な使い方。

## メニューについて

`_menu.md` は特殊なファイルで、これの中身がそのままメニューになります。

メニューに使われるファイルは以下のルールで決まります。

* そのファイルのあるディレクトリに `_menu.md` があればその内容を使う。
* もし無ければ一つ上のディレクトリに移動し、そこに `_menu.md` があればその内容を使う。
* 見つかるまで上に上り続け、Markdownの格納ディレクトリから出ると空として処理される。

上の階層のものをそのまま使っても問題ない場合は、可能な限り使いましょう。

恐らくリンクメニューに使われると思いますが、以下に例を書きます。

```
[トップ](./) <= トップページに戻る。

* はじめに
    * [はじめに](page/)　<= index.htmlは省略可能。ページの見た目的に省略推奨。
* 人　<= メニュー展開したい場合、リンクを張らないようにした方が良い。
    * [人について](page/chara/)
    * [戦士](page/chara/fighter.html)
```

注意事項としていくつかあります。

* クリックでメニュー展開などしたい場合は、JavaScriptで後付けして頑張ること。
* リンクを張る場合、一応ベースが一番上の階層になるので、そこに気を付けること。

